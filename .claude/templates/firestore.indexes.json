{
  "indexes": [
    {
      "__comment__": "Índice para buscar perfis médicos ativos de um usuário",
      "collectionGroup": "medical_profiles",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "userId",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "active",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        }
      ]
    },
    {
      "__comment__": "Índice para buscar perfil médico por CPF (compliance)",
      "collectionGroup": "medical_profiles",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "cpf",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "active",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "__comment__": "Índice para listar pagamentos de um usuário por status",
      "collectionGroup": "payments",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "userId",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "status",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        }
      ]
    },
    {
      "__comment__": "Índice para buscar pagamentos de um perfil específico",
      "collectionGroup": "payments",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "profileId",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "status",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "__comment__": "Índice para analytics de pagamentos por plano",
      "collectionGroup": "payments",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "planType",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "status",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        }
      ]
    },
    {
      "__comment__": "Índice para buscar QR Code por código único",
      "collectionGroup": "qr_codes",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "code",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "__comment__": "Índice para buscar QR Codes de um perfil",
      "collectionGroup": "qr_codes",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "profileId",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "active",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "__comment__": "Índice para QR Codes que expiram",
      "collectionGroup": "qr_codes",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "expiresAt",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "active",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "__comment__": "Índice para processar webhooks pendentes",
      "collectionGroup": "webhooks",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "processed",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "receivedAt",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "__comment__": "Índice para retry de webhooks com erro",
      "collectionGroup": "webhooks",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "processed",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "retryCount",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "receivedAt",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "__comment__": "Índice para logs de acesso emergencial por perfil",
      "collectionGroup": "emergency_access_logs",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "profileId",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "accessedAt",
          "order": "DESCENDING"
        }
      ]
    },
    {
      "__comment__": "Índice para auditoria LGPD por data",
      "collectionGroup": "lgpd_deletions",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "deletedAt",
          "order": "DESCENDING"
        }
      ]
    },
    {
      "__comment__": "Índice para analytics de QR Code mais acessados",
      "collectionGroup": "qr_codes",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "accessCount",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "active",
          "order": "ASCENDING"
        }
      ]
    }
  ],
  "fieldOverrides": [
    {
      "__comment__": "Otimização para campo array de allergies",
      "collectionGroup": "medical_profiles",
      "fieldPath": "allergies",
      "indexes": [
        {
          "order": "ASCENDING",
          "queryScope": "COLLECTION"
        },
        {
          "arrayConfig": "CONTAINS",
          "queryScope": "COLLECTION"
        }
      ]
    },
    {
      "__comment__": "Otimização para campo array de medications",
      "collectionGroup": "medical_profiles",
      "fieldPath": "medications",
      "indexes": [
        {
          "order": "ASCENDING",
          "queryScope": "COLLECTION"
        },
        {
          "arrayConfig": "CONTAINS",
          "queryScope": "COLLECTION"
        }
      ]
    }
  ]
}